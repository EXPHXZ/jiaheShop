<!DOCTYPE html>
<html lang = "en">
    <head>
        <meta charset = "UTF-8">
        <meta http-equiv = "X-UA-Compatible" content = "IE=edge">
        <meta name = "viewport" content = "width=device-width, initial-scale=1.0">
        <title>嘉禾商城首页</title>
        <link rel = "stylesheet" href = "../css/homepage.css">
    </head>

    <body>
        <div id = "app">
            <el-container>
                <el-header>
                    <el-menu class = "el-menu-demo" mode = "horizontal" :default-active = "activeIndex" background-color = "#202124"
                        text-color = "#fff" active-text-color = "#ffd04b">
                        <el-menu-item index = "1">
                            <i class = "el-icon-s-goods"></i>
                            <a href = "./homepage.html" target = "_blank">首页</a>
                        </el-menu-item>
                        <el-menu-item index = "2">
                            <i class = "el-icon-s-release"></i>
                            <a href = "https://www.ele.me" target = "_blank">售后服务</a>
                        </el-menu-item>
                        <el-menu-item index = "3">
                            <i class = "el-icon-s-order"></i>
                            <a href = "https://www.ele.me" target = "_blank">个人订单</a>
                        </el-menu-item>
                        <el-menu-item index = "4">
                            <i class = "el-icon-shopping-cart-2"></i>
                            <a href = "https://www.ele.me" target = "_blank">购物车</a>
                        </el-menu-item>
                        <a v-if = "!isLogin" class = "users" href = "usersLogin.html">登录</a>
                        <a v-if = "isLogin" class = "users" href = "usersHome.html">个人中心</a>
                        <a v-if = "isLogin" class = "users" @click = "logout">退出登录</a>
                    </el-menu>
                </el-header>
                <el-container>
                    <el-container>
                        <el-main>
                            <div class = "main-top">
                                <img src = "../images/logo.png">
                                <el-form :inline = "true" :model = "formInline" class = "demo-form-inline">
                                    <el-form-item class = "input-serach">
                                        <el-col :span = "8">
                                            <el-input v-model = "formInline.user" placeholder = "搜索"></el-input>
                                        </el-col>
                                    </el-form-item>
                                    <el-form-item>
                                        <el-button icon = "el-icon-search" @click = "onSubmit">搜索</el-button>
                                    </el-form-item>
                                </el-form>
                            </div>

                            <div class = "main-left">
                                <ul>
                                    <li v-for = "item in 13" :key = "item">
                                        <a :href = "item">{{item}}</a>
                                    </li>
                                </ul>
                            </div>

                            <div class = "block">
                                <el-carousel trigger = "click" height = "400px">
                                    <el-carousel-item v-for = "item in urls" :key = "item">
                                        <a href = "#">
                                            <el-image style = "width: 100%; height: 100%" :src = "item"
                                                :fit = "contain"></el-image>
                                        </a>
                                    </el-carousel-item>
                                </el-carousel>
                            </div>

                            <div class = "discount">
                                <h3 class = "discount-h">
                                    <i class = "el-icon-sell"></i>
                                    降价专区
                                </h3>
                                <el-row>
                                    <el-col :span = "4" v-for = "(o, index) in 5" :key = "o" :offset = "index > 0 ? 1 : 0">
                                        <el-card :body-style = "{ padding: '5px' }">
                                            <img src = "https://shadow.elemecdn.com/app/element/hamburger.9cf7b091-55e9-11e9-a976-7f4d0b07eef6.png"
                                                class = "image">
                                            <div class = "discount-w" style = "padding: 14px;">
                                                1
                                            </div>
                                        </el-card>
                                    </el-col>
                                </el-row>
                            </div>

                            <div class = "discount">
                                <h3 class = "discount-h">
                                    <i class = "el-icon-sell"></i>
                                    推荐专区
                                </h3>
                                <el-row>
                                    <el-col :span = "4" v-for = "(o, index) in 18" :key = "o">
                                        <el-card :body-style = "{ padding: '10px' }">
                                            <img src = "https://shadow.elemecdn.com/app/element/hamburger.9cf7b091-55e9-11e9-a976-7f4d0b07eef6.png"
                                                class = "image">
                                            <div class = "discount-w" style = "padding: 14px;">
                                                1
                                            </div>
                                        </el-card>
                                    </el-col>
                                </el-row>
                            </div>

                            <div class = "block">
                                <el-pagination @current-change = "handleCurrentChange" :current-page.sync = "pagination.current"
                                    :page-size = "pagination.pageSize" layout = "total, prev, pager, next"
                                    :total = "pagination.total">
                                </el-pagination>
                            </div>

                        </el-main>
                    </el-container>
                </el-container>
            </el-container>
        </div>

        <script src = "../js/vue.js"></script>
        <script src = "../element-ui/lib/index.js"></script>
        <script src = "../js/axios-0.18.0.js"></script>
        <link rel = "stylesheet" href = "../element-ui/lib/theme-chalk/index.css">

        <script>
            new Vue({
                el: "#app",

                data() {
                    return {
                        activeIndex: '1',
                        fits: ['fill', 'contain', 'cover', 'none', 'scale-down'],
                        url: 'https://fuss10.elemecdn.com/e/5d/4a731a90594a4af544c0c25941171jpeg.jpeg',
                        urls: ["../images/logo.png",
                            "../images/logo.png"
                            , "../images/logo.png",
                            "../images/logo.png"
                        ],

                        formInline: {
                            user: '',
                            region: ''
                        },

                        //分页所需数据
                        pagination: {
                            current: 1,
                            pageSize: 5,
                            total: ""
                        },

                        user:{
                        },

                        commodities:[],

                        isLogin: false,
                    }
                },

                methods: {
                    onSubmit() {
                        console.log('submit!');
                    },
                    //分页换页
                    handleCurrentChange(val) {
                        console.log(`当前页: ${val}`);
                        this.pagination.current = val;
                        this.selectAll();
                    },
                    //查询所有上架了的商品
                    SelectCommodities(){
                        axios.get("/commodity/grounding" + this.pagination.current + "/"+this.pagination.pageSize).then((res) => {
                            this.Commodities = res.data.data.records;
                            this.pagination.total = res.data.data.total;
                            this.pagination.pageSize = res.data.data.size;
                            this.pagination.current = res.data.data.current;
                        })
                    },

                    logout() {
                        axios.get("/usersManagement/logout").then((resp) => {
                            if (resp.data.code === 20061) {
                                this.$message({showClose: true, message: resp.data.msg, type: "success"})
                                window.location.reload()
                            }
                            else if (resp.data.code === 20062)
                                this.$message({showClose: true, message: resp.data.msg, type: "error"})
                            else
                                this.$message({showClose: true, message: resp.data.msg, type: "error"})
                        })
                    }
                },

                mounted(){
                    //获取用户信息
                    axios.get("/usersManagement/getLoginUser").then((resp) => {
                        if (resp.data.code === 20031)
                            this.user = resp.data.data
                        if (this.user !== null)
                            this.isLogin = true
                    })
                }
            })
        </script>
    </body>
</html>